-- 1-Donner les pays dans lesquels se trouvent des clients de cat√©gorie 1 ou 2.-- Trier-les par ordre alphab√©tique.    SELECT PAYS FROM CLIENTS WHERE CATEGORIE=1 OR  CATEGORIE=2 ORDER BY PAYS ASC;    -- 2-Donner la r√©f√©rence des produits qui ont √©t√© command√©s en quantit√© 15 ou en quantit√© 20.-- Trier-les par ordre d√©croissant.        SELECT REF_PRODUIT FROM DETAILS_COMMANDES WHERE QUANTITE=15 OR QUANTITE=20 ORDER BY REF_PRODUIT DESC;    -- 3-Donner la r√©f√©rence des produits qui ont √©t√© command√©s en quantit√© 15 et en quantit√© 20.-- Donner 2 √©critures.        SELECT REF_PRODUIT FROM DETAILS_COMMANDES WHERE QUANTITE=15 AND REF_PRODUIT IN (SELECT REF_PRODUIT FROM DETAILS_COMMANDES WHERE QUANTITE=20);    SELECT DISTINCT REF_PRODUIT FROM DETAILS_COMMANDES WHERE QUANTITE=15 INTERSECT SELECT REF_PRODUIT FROM DETAILS_COMMANDES WHERE QUANTITE=20;-- 4-Donner le code des clients espagnols qui n'ont pas command√©.-- Donner 2 √©critures.          SELECT CODE_CLIENT, SOCIETE FROM CLIENTS WHERE CODE_CLIENT NOT IN (SELECT CODE_CLIENT FROM COMMANDES) AND PAYS='Espagne';-- 5-Donner le num√©ro des commandes de aout 2008 des clients-- habitant au Royaume-Uni ou √† Toulouse.-- Afficher le jour de la commande.        SELECT NO_COMMANDE, TO_CHAR(DATE_COMMANDE,'DD') AS DATECOM FROM COMMANDES COM JOIN CLIENTS C ON COM.CODE_CLIENT=C.CODE_CLIENT WHERE TO_CHAR(DATE_COMMANDE,'MM/YYYY')='08/2008' AND (PAYS='Royaume-Uni' OR VILLE='Toulouse');-- 6-Donner le code et le pays des clients ayant command√© le produit n¬∞31.-- Afficher le pays sous cette forme : Aut. (3 premi√®res lettres + point).        SELECT DISTINCT C.CODE_CLIENT, C.PAYS FROM CLIENTS C JOIN COMMANDES COM ON C.CODE_CLIENT=COM.CODE_CLIENT JOIN DETAILS_COMMANDES D ON COM.NO_COMMANDE=D.NO_COMMANDE WHERE D.REF_PRODUIT=31;    -- 7-Donner le code et la soci√©t√© des clients de cat√©gorie 1 avec le num√©ro de leurs commandes-- (on veut afficher tous les clients m√™me ceux qui n'ont pas encore de commande).-- Trier les lignes par num√©ro de commande.    SELECT C.CODE_CLIENT, SOCIETE, NO_COMMANDE FROM CLIENTS C JOIN COMMANDES COM ON C.CODE_CLIENT=COM.CODE_CLIENT WHERE C.CATEGORIE=1 ORDER BY COM.NO_COMMANDE ASC NULLS FIRST;        SELECT CODE_CLIENT FROM CLIENTS WHERE CATEGORIE=1 AND CODE_CLIENT NOT IN (SELECT CODE_CLIENT FROM COMMANDES);    -- 8-Requ√™te 4 avec une jointure externe (anti-jointure).-- 9-Requ√™te 4 avec un NOT EXISTS.-- 10-Donner la r√©f√©rence des produits dont le nom contient 'Sauce'-- ou qui ont √©t√© command√© avec une quantit√© comprise entre 50 et 60.-- 11-Donner les produits command√©s en m√™me quantit√© dans une m√™me commande-- (uniquement si la quantit√© est sup√©rieure √† 45).-- 12-Donner pour chaque produit, les produits qui coutent 10‚Ç¨ de plus.-- Afficher les r√©f√©rences et les prix des produits-- Trier par produit.-- 13-Donner le nombre de clients qui ont command√© le produit n¬∞ 31.    SELECT COUNT(CODE_CLIENT) AS NB_CLIENT FROM COMMANDES COM JOIN DETAILS_COMMANDES D ON COM.NO_COMMANDE=D.NO_COMMANDE WHERE D.REF_PRODUIT=31;-- 14-Donner la r√©f√©rence et le nom du ou des produits les plus chers.    SELECT REF_PRODUIT FROM PRODUITS WHERE PRIX_UNITAIRE=(SELECT MAX(PRIX_UNITAIRE) FROM PRODUITS);-- 15-Donner le nombre de clients de cat√©gorie 0 ou 1 par pays (sauf la France).-- Trier par nombre d√©croissant.    SELECT COUNT(CODE_CLIENT), PAYS FROM CLIENTS WHERE (CATEGORIE=0 OR CATEGORIE=1) AND PAYS!='France' GROUP BY PAYS;-- 16-Donner le nombre de clients par pays et par cat√©gorie.-- Trier par pays, cat√©gorie.    SELECT COUNT(CODE_CLIENT)AS NB_CLIENT, CATEGORIE, PAYS FROM CLIENTS GROUP BY PAYS,CATEGORIE;-- 17-Donner les pays ayant des soci√©t√©s d'au moins 2 cat√©gories diff√©rentes.  -- 18-Donner le nombre de produits total par commande (uniquement si au moins 4 r√©f√©rences diff√©rentes).    SELECT COUNT(DISTINCT REF_PRODUIT) as NB_PRODUITS, NO_COMMANDE FROM DETAILS_COMMANDES HAVING COUNT(DISTINCT REF_PRODUIT)>=4 GROUP BY NO_COMMANDE;    -- 19-Donner la r√©f√©rence des commandes dont le montant est sup√©rieur √† 20000-- (afficher le montant total de la facture).-- V√©rifier le r√©sultat pour une facture.    SELECT SUM(PRIX_UNITAIRE) AS TOTAL,NO_COMMANDE FROM PRODUITS P JOIN DETAILS_COMMANDES D ON P.REF_PRODUIT=D.REF_PRODUIT GROUP BY NO_COMMANDE HAVING SUM(PRIX_UNITAIRE)>=20000 ORDER BY TOTAL ASC;    -- Verifier si bien 0 commande ‡ ce prix-- 20-Donner le num√©ro et la date des commandes avec au moins 4 r√©f√©rences diff√©rentes.    SELECT NO_COMMANDE, TO_CHAR(DATE_COMMANDE, 'DD/MM/YYYY') FROM COMMANDES WHERE NO_COMMANDE IN (SELECT NO_COMMANDE FROM DETAILS_COMMANDES GROUP BY (NO_COMMANDE)  HAVING COUNT(DISTINCT REF_PRODUIT)>=4);    -- 21-Donner le num√©ro des commandes contenant tous les produits qui coutent 105‚Ç¨.-- 22-Donner la r√©f√©rence des produits qui sont dans toutes les commandes de ERNSH.-- 23-Donner la r√©f√©rence du produit qui a √©t√© le plus command√©.-- 24-Donner le num√©ro des commandes de 2010 (avec le code des clients) contenant tous les produits les plus chers.